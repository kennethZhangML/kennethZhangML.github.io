<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Chapter 3 - State Prices | Kenneth Zhang </title> <meta name="author" content="Kenneth Zhang"> <meta name="description" content="Notes on State Prices in financial models."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://kennethzhangml.github.io/notes/course-1/chapter-3-state-prices/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <script defer src="https://tikzjax.com/v1/tikzjax.js"></script> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Kenneth</span> Zhang </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/notes/">notes <span class="sr-only">(current)</span> </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Chapter 3 - State Prices</h1> <p class="post-description">Notes on State Prices in financial models.</p> </header> <article> <p>Two Probability Measures covered so far:</p> <ol> <li> <strong>Actual Probability Measure</strong>: found by empirical estimation</li> <li> <strong>Risk Neutral Probability</strong>: discounted prices of assets are martingales Disagree on correct positive probabilities, agree on which paths are possible.</li> </ol> <p><strong>Radon Nikodym Derivative</strong> Consider $\Omega$ in which we have $\mathbb{P}$ and $\tilde{\mathbb{P}}$. Let’s assume that the two measures both given positive probability to every element of $\Omega$ forming the quotient:</p> \[Z(\omega) = \frac{\tilde{\mathbb{P}}(\omega)}{\mathbb{P}(\omega)}\] <p>$Z$ is a random variable since it depends on the outcome $\omega$ of a random experiment.</p> <p><strong>Properties</strong>:</p> <ol> <li>$\mathbb{P}(Z &gt; 0) = 1$</li> <li>$\mathbb{E}Z = 1$</li> <li>For any random variable $Y$ we have $\tilde{\mathbb{E}}Y = \mathbb{E}[ZY]$</li> </ol> <p>Proofs left as exercise, pretty easy proofs that follow from assumption of $\tilde{\mathbb{P}}(\omega) &gt; 0$ for $\Omega$.</p> <p>e.g., Consider the probability space:</p> \[\Omega = \{HHH, HHT, HTH, HTT, THH, THT, TTH, TTT\}\] <p>We take $p = \frac{2}{3}$ and $q = \frac{1}{3}$ then the actual probability measures are:</p> \[\begin{align} \mathbb{P}(HHH) &amp;= \left(\frac{2}{3}\right)^3 = \frac{8}{27}, \\ \mathbb{P}(HHT) &amp;= \left(\frac{2}{3}\right)^2 \times \left(\frac{1}{3}\right) = \frac{4}{27}, \\ \mathbb{P}(HTH) &amp;= \left(\frac{2}{3}\right) \times \left(\frac{1}{3}\right) \times \left(\frac{2}{3}\right) = \frac{4}{27}, \\ \mathbb{P}(HTT) &amp;= \left(\frac{2}{3}\right) \times \left(\frac{1}{3}\right)^2 = \frac{2}{27}, \\ \mathbb{P}(THH) &amp;= \left(\frac{1}{3}\right) \times \left(\frac{2}{3}\right)^2 = \frac{4}{27}, \\ \mathbb{P}(THT) &amp;= \left(\frac{1}{3}\right) \times \left(\frac{2}{3}\right) \times \left(\frac{1}{3}\right) = \frac{2}{27}, \\ \mathbb{P}(TTH) &amp;= \left(\frac{1}{3}\right)^2 \times \left(\frac{2}{3}\right) = \frac{2}{27}, \\ \mathbb{P}(TTT) &amp;= \left(\frac{1}{3}\right)^3 = \frac{1}{27}. \end{align}\] <p>Then, the risk-neutral probabilities are computed as:</p> \[\begin{align} \tilde{\mathbb{P}}(HHH) &amp;= \tilde{\mathbb{P}}(HHT) = \tilde{\mathbb{P}}(HTH) = \tilde{\mathbb{P}}(HTT) \\ &amp;= \tilde{\mathbb{P}}(THH) = \tilde{\mathbb{P}}(THT) = \tilde{\mathbb{P}}(TTH) = \tilde{\mathbb{P}}(TTT) = \frac{1}{8}. \end{align}\] <p>Using the Radon-Nikodym derivative, we have:</p> \[\begin{align} Z(HHH) &amp;= \frac{\mathbb{P}(HHH)}{\tilde{\mathbb{P}}(HHH)} = \frac{8/27}{1/8} = \frac{64}{27}, \\ Z(HHT) &amp;= \frac{\mathbb{P}(HHT)}{\tilde{\mathbb{P}}(HHT)} = \frac{4/27}{1/8} = \frac{32}{27}, \\ Z(HTH) &amp;= \frac{\mathbb{P}(HTH)}{\tilde{\mathbb{P}}(HTH)} = \frac{4/27}{1/8} = \frac{32}{27}, \\ Z(HTT) &amp;= \frac{\mathbb{P}(HTT)}{\tilde{\mathbb{P}}(HTT)} = \frac{2/27}{1/8} = \frac{16}{27}, \\ Z(THH) &amp;= \frac{\mathbb{P}(THH)}{\tilde{\mathbb{P}}(THH)} = \frac{4/27}{1/8} = \frac{32}{27}, \\ Z(THT) &amp;= \frac{\mathbb{P}(THT)}{\tilde{\mathbb{P}}(THT)} = \frac{2/27}{1/8} = \frac{16}{27}, \\ Z(TTH) &amp;= \frac{\mathbb{P}(TTH)}{\tilde{\mathbb{P}}(TTH)} = \frac{2/27}{1/8} = \frac{16}{27}, \\ Z(TTT) &amp;= \frac{\mathbb{P}(TTT)}{\tilde{\mathbb{P}}(TTT)} = \frac{1/27}{1/8} = \frac{8}{27}. \end{align}\] <p>Given $V_3$’s we can take the expected value of the discounted prices at time $3$ to get $0$:</p> \[V_0 = \tilde{\mathbb{E}} \frac{V_3}{(1 + r)^3} = 1.376\] <p><strong>Definition</strong> In the $N$-period binomial model with actual probability measure $\mathbb{P}$ and risk-neutral probability measure $\tilde{\mathbb{P}}$, let $Z$ denote the <strong>Radon-Nikodým derivative</strong> of $\tilde{\mathbb{P}}$ with respect to $\mathbb{P}$;</p> \[Z(\omega_1 \dots \omega_N) = \frac{\tilde{\mathbb{P}}(\omega_1 \dots \omega_N)}{\mathbb{P}(\omega_1 \dots \omega_N)} = \left( \frac{\tilde{p}}{p} \right)^{\#H(\omega_1 \dots \omega_N)} \left( \frac{\tilde{q}}{q} \right)^{\#T(\omega_1 \dots \omega_N)},\] <p>where $#H(\omega_1 \dots \omega_N)$ denotes the number of heads appearing in the sequence $\omega_1 \dots \omega_N$ and $#T(\omega_1 \dots \omega_N)$ denotes the number of tails appearing in this sequence. The <strong>state price density random variable</strong> is given by: \(\zeta(\omega) = \frac{Z(\omega)}{(1 + r)^N},\) and $\zeta(\omega) \mathbb{P}(\omega)$ is called the <strong>state price corresponding to</strong> $\omega$. Let $\bar{\omega} = \bar{\omega}_1 \dots \bar{\omega}_N$ be a particular coin toss sequence in the $N$-period model, and consider a <strong>derivative security</strong> that pays off 1 if $\bar{\omega}$ occurs and otherwise pays off 0; i.e.,</p> \[V_N(\omega) = \begin{cases} 1, &amp; \text{if } \omega = \bar{\omega}, \\ 0, &amp; \text{otherwise}. \end{cases}\] <p>According to the <strong>risk-neutral pricing formula</strong>, value of this derivative security at time zero is:</p> \[\mathbb{E}^{\tilde{\mathbb{P}}} \left[ \frac{V_N}{(1 + r)^N} \right] = \frac{\tilde{\mathbb{P}}(\bar{\omega})}{(1 + r)^N} = \frac{Z(\bar{\omega}) \mathbb{P}(\bar{\omega})}{(1 + r)^N} = \zeta(\bar{\omega}) \mathbb{P}(\bar{\omega}).\] <p>We see that the <strong>state price</strong> $\zeta(\bar{\omega}) \mathbb{P}(\bar{\omega})$ tells the price at time zero of a contract that pays 1 at time $N$ <strong>if and only if</strong> $\bar{\omega}$ occurs. This price should include a <strong>risk-adjusted discounting factor</strong>.</p> <p><strong>Theorem</strong>: $Z$ is an r.v. (Radon Nikodym Derivative), in an N-period binomial model,</p> \[Z_n = \mathbb{E}_n Z,\quad n = 0, 1, \dots, N\] <p>$Z_n$ for $n = 0, 1, \dots, N$ is a martingale under actual probability measure $\mathbb{P}$.</p> \[\mathbb{E}_n [Z_{n + 1}] = \mathbb{E}_n [\mathbb{E}_{n + 1}[Z]] = \mathbb{E}_n [Z] = Z_n\] <p>e.g., $n = 0, 1, 2, 3$ define $Z_n = \mathbb{E}_n [Z]$, specifically:</p> \[Z_3(\omega_1 \omega_2 \omega_3) = Z(\omega_1 \omega_2 \omega_3)\quad \text{for all } \omega_1 \omega_2 \omega_3\] \[\begin{align} Z_2(HH) &amp;= \frac{2}{3} Z_3(HHH) + \frac{1}{3} Z_3(HHT) = \frac{9}{16}, \\ Z_2(HT) &amp;= \frac{2}{3} Z_3(HTH) + \frac{1}{3} Z_2(HTT) = \frac{9}{8}, \\ Z_2(TH) &amp;= \frac{2}{3} Z_3(THH) + \frac{1}{3} Z_2(THT) = \frac{9}{8}, \\ Z_2(TT) &amp;= \frac{2}{3} Z_2(TTH) + \frac{1}{3} Z_2^2(TTT) = \frac{9}{4}. \end{align}\] <p>$Z_1 = \mathbb{E}_1 [Z]$ but we compute it using the martingale $Z_1 = \mathbb{E}[Z_2]$, giving:</p> \[\begin{align} Z_1(H) &amp;= \frac{2}{3} Z_2(HH) + \frac{1}{3} Z_2(HT) = \frac{3}{4}, \\ Z_1(T) &amp;= \frac{2}{3} Z_1(TH) + \frac{1}{3} Z_1(TT) = \frac{3}{2}. \end{align}\] <p>Then we further “discount” by martingales to achieve the following:</p> \[\begin{align} Z_0 &amp;= \frac{2}{3} Z_1(H) + \frac{1}{3} Z_1(T) = 1. \end{align}\] <p><strong>Definition</strong>: The <strong>Radon Nikodym</strong> derivative process is given by:</p> \[Z_n = \mathbb{E}_n [Z],\quad n = 0, 1, \dots, N\] <p>Specifically, $Z_N = Z$ and $Z_0 = 1$.</p> <p><strong>Lemma</strong>: Assume conditions for the derivative process above, let $Y$ be an r.v. depending only on the first $n$ coin tosses:</p> \[\tilde{\mathbb{E}}Y = \mathbb{E}[Z_n Y]\] <p>Use theorem to prove, and definition $Z_n$ to define:</p> \[\tilde{\mathbb{E}}Y = \mathbb{E}[ZY] = \mathbb{E}[\mathbb{E}_n [ZY]] = \mathbb{E}[Y \mathbb{E}_n [Z]] = \mathbb{E}[Y Z_n]\] <p>$Y$ takes value 1 if and only if the first $n$ coin tosses result in the particular sequence $\overline{\omega_1}, \dots, \overline{\omega_n}$ we have fixed in advance. The coin tosses $\omega_{n + 1}, \dots, \omega_N$ are irrelevant. For each $n$, $Z_n(\omega_1, \dots, \omega_n$) is the ratio of the risk-neutral probability and the actual probability of obtaining the sequence of coin tosses $\omega_1, \dots, \omega_n$. Lemma, asserts that, if $Y$ depends only on the first $n$ coin tosses, then we do not need to consider the coin tosses after time $n$.</p> <p><strong>Note</strong>: Might use $Z_n$ as a surrogate for the Radon Nikodym derivative $Z$ in the formula:</p> \[\tilde{\mathbb{E}}Y = \mathbb{E}[ZY]\] <p><strong>Lemma</strong>: Assume conditions of our definition, and $Y$ is a random variable depending only on the first $m$ coin tosses:</p> \[\tilde{\mathbb{E}}_n [Y] = \frac{1}{Z_n} \mathbb{E}_n [Z_m Y]\] <p><strong>Theorem</strong>: Price of Derivative Security at $n$ by Radon-Nikodym Process Consider an $N$-period binomial model with $0 &lt; d &lt; 1 + r &lt; u$. Assume that the actual probability for head, $p$, and the actual probability for tail, $q$, are positive. The risk-neutral probabilities for head and tail are given, as usual, by:</p> \[\tilde{p} = \frac{1 + r - d}{u - d}, \quad \tilde{q} = \frac{u - 1 - r}{u - d},\] <p>and these are also both positive. Let $\mathbb{P}$ and $\tilde{\mathbb{P}}$ denote the corresponding actual and risk-neutral probability measures, respectively. Let $Z$ be the <strong>Radon-Nikodým derivative</strong> of $\tilde{\mathbb{P}}$ with respect to $\mathbb{P}$, and let $Z_n$, for $n = 0, 1, \dots, N$, be the <strong>Radon-Nikodým derivative process</strong>. Consider a <strong>derivative security</strong> whose payoff $V_N$ may depend on all $N$ coin tosses. For $n = 0, 1, \dots, N$, the price at time $n$ of this derivative security is:</p> \[V_n = \mathbb{E}^{\tilde{\mathbb{P}}}_n \left[ \frac{V_N}{(1 + r)^{N - n}} \right] = \frac{(1 + r)^n}{Z_n} \mathbb{E}_n \left[ \frac{Z_N V_N}{(1 + r)^N} \right] = \frac{1}{\zeta_n} \mathbb{E}_n [\zeta_N V_N]\] <p>where the <strong>state price density process</strong> $\zeta_n$ is defined by:</p> \[\zeta_n = \frac{Z_n}{(1 + r)^n}, \quad n = 0, 1, \dots, N.\] <p><strong>Problem</strong>: Optimal Investment: Given $X_0$, find an adapted portfolio process $\Delta_0, \Delta_1, \dots, \Delta_{N - 1}$ that maximizes:</p> \[\mathbb{E}U(X_N)\] <p>subject to the wealth equation:</p> \[X_{n + 1} = \Delta_n S_{n + 1} + (1 + r)(X_n - \Delta_n S_n),\quad n = 0, 1, \dots, N - 1\] <p>Risk averse agents use utility functions $U$ to capture trade-off between actual risk and actual return. It does not make sense to do this under a risk-neutral measure because under the risk-neutral measure, both the stock and money-market account have the same rate of return.</p> <p>e.g., Consider a two-period model with $S_0 = 4$ and $u = 2, d = \frac{1}{2}$ and assume that $r = \frac{1}{4}$</p> \[\begin{align*} X_1(H) &amp;= S_1(H) \Delta_0 + \text{cash balance growth} \\ &amp;= 8\Delta_0 + \left(4 - 4\Delta_0\right) \left(1 + \frac{1}{4}\right) \\ &amp;= 8\Delta_0 + \frac{5}{4} (4 - 4\Delta_0) \\ &amp;= 3\Delta_0 + 5. \\ X_1(T) &amp;= S_1(T) \Delta_0 + \text{cash balance growth} \\ &amp;= 2\Delta_0 + \left(4 - 4\Delta_0\right) \left(1 + \frac{1}{4}\right) \\ &amp;= 2\Delta_0 + \frac{5}{4} (4 - 4\Delta_0) \\ &amp;= -3\Delta_0 + 5. \\ \end{align*}\] \[\begin{align*} X_2(HH) &amp;= 16\Delta_1(H) + \frac{5}{4} (X_1(H) - 8\Delta_1(H)) \\ &amp;= 6\Delta_1(H) + \frac{15}{4} \Delta_0 + \frac{25}{4}, \\ X_2(HT) &amp;= 4\Delta_1(H) + \frac{5}{4} (X_1(H) - 8\Delta_1(H)) \\ &amp;= -6\Delta_1(H) + \frac{15}{4} \Delta_0 + \frac{25}{4}, \\ X_2(TH) &amp;= 4\Delta_1(T) + \frac{5}{4} (X_1(T) - 2\Delta_1(T)) \\ &amp;= \frac{3}{2} \Delta_1(T) - \frac{15}{4} \Delta_0 + \frac{25}{4}, \\ X_2(TT) &amp;= \Delta_1(T) + \frac{5}{4} (X_1(T) - 2\Delta_1(T)) \\ &amp;= -\frac{3}{2} \Delta_1(T) - \frac{15}{4} \Delta_0 + \frac{25}{4}. \\ \mathbb{E} \ln X_2 &amp;= \frac{4}{9} \ln X_2(HH) + \frac{2}{9} \ln X_2(HT) \\ &amp;+ \frac{2}{9} \ln X_2(TH) + \frac{1}{9} \ln X_2(TT). \end{align*}\] <p>Where we are aiming to maximize $\mathbb{E} \ln X_2$.</p> \[\begin{align*} \frac{\partial}{\partial \Delta_0} \mathbb{E} \ln X_2 &amp;= 0 \Rightarrow \frac{4}{X_2(HH)} + \frac{2}{X_2(HT)} - \frac{2}{X_2(TH)} - \frac{1}{X_2(TT)} = 0, \\ \frac{\partial}{\partial \Delta_1(H)} \mathbb{E} \ln X_2 &amp;= 0 \Rightarrow \frac{2}{X_2(HH)} = \frac{1}{X_2(HT)}, \\ \frac{\partial}{\partial \Delta_1(T)} \mathbb{E} \ln X_2 &amp;= 0 \Rightarrow \frac{2}{X_2(TH)} = \frac{1}{X_2(TT)}. \\ \end{align*}\] <p>This gives us three linear equations with 4 unknowns, where we can get:</p> \[\begin{align*} X_2(HH) &amp;= 2X_2(HT), \quad X_2(TH) = 2X_2(TT), \\ X_2(HH) &amp;= 100/9, \quad X_2(HT) = 50/9, \\ X_2(TH) &amp;= 50/9, \quad X_2(TT) = 25/9. \\ \Delta_1(H) &amp;= \frac{X_2(HH) - X_2(HT)}{S_2(HH) - S_2(HT)} = \frac{25}{54}, \\ \Delta_1(T) &amp;= \frac{X_2(TH) - X_2(TT)}{S_2(TH) - S_2(TT)} = \frac{25}{27}, \\ \Delta_0 &amp;= \frac{X_1(H) - X_1(T)}{S_1(H) - S_1(T)} = \frac{5}{9}. \end{align*}\] <p><strong>Problem</strong>: Given $X_0$ we want to find a random variable $X_N$ without regard to the portfolio process, that maximizes:</p> \[\mathbb{E} U(X_N)\] <p>subject to:</p> \[\tilde{\mathbb{E}} \frac{X_N}{(1 + r)^N} = X_0\] <p><strong>Lemma</strong>: Suppose we have $\Delta_0^<em>, \Delta_1^</em>, \dots, \Delta_{N - 1}^<em>$ is an optimal portfolio process for the optimal investment problem and $X_N^</em>$ is the corresponding optimal wealth random variable at time $N$. Then $X_N^<em>$ is optimal for the Maximizing Utility Function problem. Conversely, suppose $X_N^</em>$ is optimal for the utility function problem. Then there is a portfolio process that starts with initial wealth $X_0$ and has value $X_N^*$ at time $N$, and this portfolio process is optimal for the optimal investment problem.</p> <p>e.g., Let’s take the same Radon-Nikodym derivative from the problem we previously went though with the derivative of $\tilde{\mathbb{P}}$ wrt $\mathbb{P}$.</p> \[\begin{align} Z(HH) &amp;= \frac{\tilde{\mathbb{P}}(HH)}{\mathbb{P}(HH)} = \frac{9}{16}, \quad Z(HT) = \frac{\tilde{\mathbb{P}}(HT)}{\mathbb{P}(HT)} = \frac{9}{8}, \\[8pt] Z(TH) &amp;= \frac{\tilde{\mathbb{P}}(TH)}{\mathbb{P}(TH)} = \frac{9}{8}, \quad Z(TT) = \frac{\tilde{\mathbb{P}}(TT)}{\mathbb{P}(TT)} = \frac{9}{4}. \end{align}\] <p>We simplify by using subscripts to denote different values of the state price density $\zeta$.</p> \[\begin{align} \zeta_1 &amp;= \zeta(HH) = \frac{Z(HH)}{(1 + r)^2} = \frac{9}{25}, \\[8pt] \zeta_2 &amp;= \zeta(HT) = \frac{Z(HT)}{(1 + r)^2} = \frac{18}{25}, \\[8pt] \zeta_3 &amp;= \zeta(TH) = \frac{Z(TH)}{(1 + r)^2} = \frac{18}{25}, \\[8pt] \zeta_4 &amp;= \zeta(TT) = \frac{Z(TT)}{(1 + r)^2} = \frac{36}{25}. \end{align}\] <p>We use notation below to denote the respective probabilities of the possible $\Omega$ sequences:</p> \[\begin{align} p_1 &amp;= \mathbb{P}(HH) = \frac{4}{9}, \quad p_2 = \mathbb{P}(HT) = \frac{2}{9}, \\[8pt] p_3 &amp;= \mathbb{P}(TH) = \frac{2}{9}, \quad p_4 = \mathbb{P}(TT) = \frac{1}{9}. \end{align}\] <p>We denote the wealth, given a sequence, by:</p> \[\begin{align} x_1 &amp;= X_2(HH), \quad x_2 = X_2(HT), \quad x_3 = X_2(TH), \quad x_4 = X_2(TT). \end{align}\] <p>Thus, we have the problem:</p> \[\begin{align} \text{Maximize} \quad &amp; \sum_{m=1}^{4} p_m \ln x_m, \\[8pt] \text{subject to} \quad &amp; \sum_{m=1}^{4} p_m x_m \zeta_m = X_0. \end{align}\] <p>which we can take the log of and expand:</p> \[\begin{align} L &amp;= \sum_{m=1}^{4} p_m \ln x_m - \lambda \left( \sum_{m=1}^{4} p_m x_m \zeta_m - X_0 \right). \end{align}\] <p>This is clearly a lagrangian, where we can use the lagrangian multiplier and get partials as:</p> \[\begin{align} \frac{\partial L}{\partial x_1} &amp;= \frac{4}{9} \left(\frac{1}{x_1} - \lambda \frac{9}{25} \right) = 0, \\[8pt] \frac{\partial L}{\partial x_2} &amp;= \frac{2}{9} \left(\frac{1}{x_2} - \lambda \frac{18}{25} \right) = 0, \\[8pt] \frac{\partial L}{\partial x_3} &amp;= \frac{2}{9} \left(\frac{1}{x_3} - \lambda \frac{18}{25} \right) = 0, \\[8pt] \frac{\partial L}{\partial x_4} &amp;= \frac{1}{9} \left(\frac{1}{x_4} - \lambda \frac{36}{25} \right) = 0. \end{align}\] <p>Thus, we get:</p> \[\begin{align} x_1 &amp;= \frac{25}{9\lambda}, \quad x_2 = \frac{25}{18\lambda}, \quad x_3 = \frac{25}{18\lambda}, \quad x_4 = \frac{25}{36\lambda}. \end{align}\] <p>We can solve for $1 / \lambda$ which can be substituted into our formula:</p> \[\begin{align} \frac{4}{9} \frac{9}{25} x_1 + \frac{2}{9} \frac{18}{25} x_2 + \frac{2}{9} \frac{18}{25} x_3 + \frac{1}{9} \frac{36}{25} x_4 &amp;= 4. \end{align}\] \[\begin{align} \frac{4}{9} \frac{9}{25} \frac{25}{9\lambda} + \frac{2}{9} \frac{18}{25} \frac{25}{18\lambda} + \frac{2}{9} \frac{18}{25} \frac{25}{18\lambda} + \frac{1}{9} \frac{36}{25} \frac{25}{36\lambda} &amp;= 4. \end{align}\] \[\begin{align} \frac{4}{9\lambda} + \frac{2}{9\lambda} + \frac{2}{9\lambda} + \frac{1}{9\lambda} &amp;= 4. \end{align}\] \[\begin{align} \frac{9}{9\lambda} &amp;= 4, \quad \Rightarrow \quad \frac{1}{\lambda} = 4. \end{align}\] <p>Our optimal wealth at time 2 is given as,</p> \[\begin{align} X_2(HH) &amp;= x_1 = \frac{100}{9}, \\[8pt] X_2(HT) &amp;= x_2 = \frac{50}{9}, \\[8pt] X_2(TH) &amp;= x_3 = \frac{50}{9}, \\[8pt] X_2(TT) &amp;= x_4 = \frac{25}{9}. \end{align}\] <p>Now, we can find $\Delta_0, \Delta_1(H), \Delta_1(T)$ as we did following the previous discounting method. We re-write the Radon-Nikodym derivative of $Z$ without reference to the risk-neutral measure,</p> \[\mathbb{E} \frac{Z_N X_N}{(1 + r)^N} = X_0 \implies \mathbb{E}_{\zeta} X_N = X_0\] <p>In an N-period model, we have $2^N$ possible coin toss sequences $\omega$ which are listed as</p> \[\omega^1, \omega^2, \dots, \omega^M\] <p>where $M = 2^N$. Thus we formalize this as, given $X_0$ we wish to find $(x_1, x_2, \dots, x_M)$ that maximizes the following summation:</p> \[\begin{align} \text{Maximize} \quad &amp; \sum_{m=1}^{M} p_m U(x_m) \\[8pt] \text{subject to} \quad &amp; \sum_{m=1}^{M} p_m x_m \zeta_m = X_0. \end{align}\] <p>The lagrangian, as defined specifically, previously, is now generally written as:</p> \[\begin{align} L &amp;= \sum_{m=1}^{M} p_m U(x_m) - \lambda \left( \sum_{m=1}^{M} p_m x_m \zeta_m - X_0 \right). \end{align}\] <p>With multiplier equations:</p> \[\begin{align} \frac{\partial L}{\partial x_m} &amp;= p_m U'(x_m) - \lambda p_m \zeta_m = 0, \quad m = 1, 2, \dots, M. \end{align}\] \[\begin{align} U'(x_m) &amp;= \lambda \zeta_m, \quad m = 1, 2, \dots, M. \end{align}\] <p>We can reduce to the above, recalling how $x_m$ and $\zeta_m$ were defined:</p> \[\begin{align} X_N &amp;= I \left( \frac{\lambda Z}{(1 + r)^N} \right). \end{align}\] </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Kenneth Zhang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://tikzjax.com/v1/tikzjax.js" integrity="sha256-+1qyucCXRZJrCg3lm3KxRt/7WXaYhBid4/1XJRHGB1E=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],tags:"ams"},svg:{scale:1.1,minScale:.8,matchFontHeight:!1}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-cv",title:"cv",description:"",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"nav-publications",title:"publications",description:"",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-notes",title:"notes",description:"Personal-study notes for quant-finance related learning materials",section:"Navigation",handler:()=>{window.location.href="/notes/"}},{id:"notes-stochastic-calculus-for-finance-i",title:"Stochastic Calculus for Finance I",description:"My personal notes for Shreve&#39;s Stochastic Calculus for Finance I",section:"Notes",handler:()=>{window.location.href="/notes/course-1/"}},{id:"notes-stochastic-calculus-for-finance-ii",title:"Stochastic Calculus for Finance II",description:"My personal notes for Shreve&#39;s Stochastic Calculus for Finance II",section:"Notes",handler:()=>{window.location.href="/notes/course-2/"}},{id:"notes-chapter-1-no-arbitrage-pricing-model",title:"Chapter 1 - No-Arbitrage Pricing Model",description:"Notes on the No-Arbitrage Pricing Model.",section:"Notes",handler:()=>{window.location.href="/notes/course-1/chapter-1-no-arbitrage/"}},{id:"notes-chapter-1-exercises",title:"Chapter 1 Exercises",description:"Exercises for Chapter 1 - No-Arbitrage Pricing Model.",section:"Notes",handler:()=>{window.location.href="/notes/course-1/chapter-1-exercises/"}},{id:"notes-chapter-2-exercises",title:"Chapter 2 Exercises",description:"Exercises for Chapter 2 - Probability Theory on Coin Toss Space.",section:"Notes",handler:()=>{window.location.href="/notes/course-1/chapter-2-exercises/"}},{id:"notes-chapter-2-probability-theory-on-coin-toss-space",title:"Chapter 2 - Probability Theory on Coin Toss Space",description:"Notes on probability theory applied to coin toss spaces.",section:"Notes",handler:()=>{window.location.href="/notes/course-1/chapter-2-probability/"}},{id:"notes-chapter-3-state-prices",title:"Chapter 3 - State Prices",description:"Notes on State Prices in financial models.",section:"Notes",handler:()=>{window.location.href="/notes/course-1/chapter-3-state-prices/"}},{id:"notes-chapter-3-exercises",title:"Chapter 3 Exercises",description:"Exercises for Chapter 3 - State Prices.",section:"Notes",handler:()=>{window.location.href="/notes/course-1/chapter-3-exercises/"}},{id:"notes-chapter-1-general-probability-theory",title:"Chapter 1 - General Probability Theory",description:"Notes on general probability theory and foundational concepts.",section:"Notes",handler:()=>{window.location.href="/notes/course-2/chapter-1-general-probability/"}},{id:"notes-chapter-1-probability-exercises",title:"Chapter 1 - Probability Exercises",description:"Exercises for Chapter 1 - General Probability Theory.",section:"Notes",handler:()=>{window.location.href="/notes/course-2/chapter-1-probability-exercises/"}},{id:"notes-chapter-2-information-exercises",title:"Chapter 2 - Information Exercises",description:"Exercises for Chapter 2 - Information and Conditioning.",section:"Notes",handler:()=>{window.location.href="/notes/course-2/chapter-2-information-exercises/"}},{id:"notes-chapter-2-information-and-conditioning",title:"Chapter 2 - Information and Conditioning",description:"Notes on information theory and conditional probability.",section:"Notes",handler:()=>{window.location.href="/notes/course-2/chapter-2-information-conditioning/"}},{id:"notes-chapter-3-brownian-motion-exercises",title:"Chapter 3 - Brownian Motion Exercises",description:"Exercises for Chapter 3 - Brownian Motion.",section:"Notes",handler:()=>{window.location.href="/notes/course-2/chapter-3-brownian-motion-exercises/"}},{id:"notes-chapter-3-brownian-motion",title:"Chapter 3 - Brownian Motion",description:"Notes on Brownian motion and its applications.",section:"Notes",handler:()=>{window.location.href="/notes/course-2/chapter-3-brownian-motion/"}},{id:"notes-chapter-4-stochastic-calculus-exercises",title:"Chapter 4 - Stochastic Calculus Exercises",description:"Notes on Stochastic Calculus and its applications.",section:"Notes",handler:()=>{window.location.href="/notes/course-2/chapter-4-stochastic-calculus-exercises/"}},{id:"notes-chapter-4-stochastic-calculus",title:"Chapter 4 - Stochastic Calculus",description:"Notes on Brownian motion and its applications.",section:"Notes",handler:()=>{window.location.href="/notes/course-2/chapter-4-stochastic-calculus/"}},{id:"notes-chapter-6-partial-differential-equations-exercises",title:"Chapter 6 - Partial Differential Equations Exercises",description:"Notes on Partial Differential Equations and its applications.",section:"Notes",handler:()=>{window.location.href="/notes/course-2/chapter-4-PDEs-exercises/"}},{id:"notes-chapter-6-partial-differential-equations",title:"Chapter 6 - Partial Differential Equations",description:"Notes on Partial Differential Equations and its applications.",section:"Notes",handler:()=>{window.location.href="/notes/course-2/chapter-4-PDEs/"}},{id:"projects-the-lagging-indicator-chronicles-a-tale-of-policies-playing-catch-up",title:"The Lagging Indicator Chronicles \u2013 A Tale of Policies Playing Catch-Up",description:"Lag time between state-level policy interventions and change points in COVID-19 outcomes in the United States. Read more at ![this article](https://www.cell.com/patterns/fulltext/S2666-3899(21)00149-5).",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"projects-pm2-5-and-the-great-regulatory-vanishing-act-when-pollution-took-a-free-pass",title:"PM2.5 and the Great Regulatory Vanishing Act - When Pollution Took a Free...",description:"An introduction to the statistical models used to assess the impact of EPA rollbacks on air quality in California. https://enveurope.springeropen.com/articles/10.1186/s12302-021-00489-9",section:"Projects",handler:()=>{window.location.href="/projects/2_project/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%79%6F%75@%65%78%61%6D%70%6C%65.%63%6F%6D","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=qc6CJjYAAAAJ","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> <script defer src="https://tikzjax.com/v1/tikzjax.js" integrity="sha256-+1qyucCXRZJrCg3lm3KxRt/7WXaYhBid4/1XJRHGB1E=" crossorigin="anonymous"></script> </body> </html>